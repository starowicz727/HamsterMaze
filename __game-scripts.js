var CharacterManagerScript=pc.createScript("CharacterManagerScript");CharacterManagerScript.attributes.add("power",{type:"number",default:40,description:"Adjusts the speed of player movement"}),CharacterManagerScript.attributes.add("playerObj",{type:"entity"}),CharacterManagerScript.attributes.add("bulletType",{type:"entity"}),CharacterManagerScript.attributes.add("moveLeftBtn",{type:"number",default:pc.KEY_A}),CharacterManagerScript.attributes.add("moveRightBtn",{type:"number",default:pc.KEY_D}),CharacterManagerScript.attributes.add("moveUpBtn",{type:"number",default:pc.KEY_W}),CharacterManagerScript.attributes.add("moveDownBtn",{type:"number",default:pc.KEY_S}),CharacterManagerScript.attributes.add("shootBtn",{type:"number",default:pc.KEY_TAB}),CharacterManagerScript.attributes.add("pointsUI",{type:"entity"}),CharacterManagerScript.prototype.initialize=function(){this.app.keyboard.on(pc.EVENT_KEYDOWN,this.onKeyDown,this),this.on("destroy",(function(){this.app.keyboard.off(pc.EVENT_KEYDOWN,this.onKeyDown,this)}),this),this.facingRight=!1,this.facingLeft=!0,this.facingUp=!1,this.facingDown=!1},CharacterManagerScript.prototype.onKeyDown=function(t){t.event.preventDefault()},CharacterManagerScript.prototype.update=function(t){var e=this.app,i=this.playerObj.getLocalPosition();this.entity.getLocalPosition();e.keyboard.isPressed(this.moveRightBtn)&&(0!=this.facingRight||e.keyboard.isPressed(this.moveLeftBtn)||e.keyboard.isPressed(this.moveUpBtn)||e.keyboard.isPressed(this.moveDownBtn)||(this.playerObj.rigidbody.teleport(i.x,i.y,i.z,0,180,0),this.facingRight=!0,this.facingLeft=!1,this.facingUp=!1,this.facingDown=!1),this.playerObj.rigidbody.applyImpulse(0,0,-1*this.power)),e.keyboard.isPressed(this.moveLeftBtn)&&(0!=this.facingLeft||e.keyboard.isPressed(this.moveRightBtn)||e.keyboard.isPressed(this.moveUpBtn)||e.keyboard.isPressed(this.moveDownBtn)||(this.playerObj.rigidbody.teleport(i.x,i.y,i.z,0,0,0),this.facingRight=!1,this.facingLeft=!0,this.facingUp=!1,this.facingDown=!1),this.playerObj.rigidbody.applyImpulse(0,0,this.power)),e.keyboard.isPressed(this.moveUpBtn)&&(0!=this.facingUp||e.keyboard.isPressed(this.moveLeftBtn)||e.keyboard.isPressed(this.moveRightBtn)||e.keyboard.isPressed(this.moveDownBtn)||(this.playerObj.rigidbody.teleport(i.x,i.y,i.z,0,-90,0),this.facingRight=!1,this.facingLeft=!1,this.facingUp=!0,this.facingDown=!1),this.playerObj.rigidbody.applyImpulse(-1*this.power,0,0)),e.keyboard.isPressed(this.moveDownBtn)&&(0!=this.facingDown||e.keyboard.isPressed(this.moveLeftBtn)||e.keyboard.isPressed(this.moveUpBtn)||e.keyboard.isPressed(this.moveRightBtn)||(this.playerObj.rigidbody.teleport(i.x,i.y,i.z,0,90,0),this.facingRight=!1,this.facingLeft=!1,this.facingUp=!1,this.facingDown=!0),this.playerObj.rigidbody.applyImpulse(this.power,0,0))};var AssignHamsters=pc.createScript("assignHamsters");AssignHamsters.attributes.add("player1Obj",{type:"entity"}),AssignHamsters.attributes.add("player2Obj",{type:"entity"}),AssignHamsters.attributes.add("materialsHamYellow",{type:"asset",assetType:"material",array:!0,title:"MaterialsHamYellow"}),AssignHamsters.attributes.add("materialsHamPink",{type:"asset",assetType:"material",array:!0,title:"MaterialsHamPink"}),AssignHamsters.attributes.add("materialsHamGreen",{type:"asset",assetType:"material",array:!0,title:"MaterialsHamGreen"}),AssignHamsters.attributes.add("materialsHamBlack",{type:"asset",assetType:"material",array:!0,title:"MaterialsHamBlack"}),AssignHamsters.attributes.add("bulletTypes",{type:"entity",array:!0,title:"Bullets"}),AssignHamsters.prototype.initialize=function(){var t=this.player1Obj.findComponents("render"),e=this.player2Obj.findComponents("render"),a=[],l=[];for(i=0;i<t.length;++i)for(var s=t[i].meshInstances,r=e[i].meshInstances,o=0;o<s.length;o++)a.push(s[o]),l.push(r[o]);var n=null,p=null,y=null,m=null;localStorage?(player1=localStorage.getItem("Player1"),"BtnYellow1"==player1?(n=this.materialsHamYellow,y=this.bulletTypes[0],console.log("setting player 1 color to: yellow")):"BtnPink1"==player1?(n=this.materialsHamPink,y=this.bulletTypes[1],console.log("setting player 1 color to: pink")):"BtnGreen1"==player1?(n=this.materialsHamGreen,y=this.bulletTypes[2],console.log("setting player 1 color to: green")):"BtnBlack1"==player1?(n=this.materialsHamBlack,y=this.bulletTypes[3],console.log("setting player 1 color to: black")):(n=this.materialsHamYellow,y=this.bulletTypes[0],console.log("setting player 1 color to default: yellow"))):(n=this.materialsHamYellow,console.log("setting player 1 color to default: yellow"));for(var c=0;c<2;c++)a[c].material=n[c].resource;localStorage?(player2=localStorage.getItem("Player2"),"BtnYellow2"==player2?(p=this.materialsHamYellow,m=this.bulletTypes[0],console.log("setting player 2 color to: yellow")):"BtnPink2"==player2?(p=this.materialsHamPink,m=this.bulletTypes[1],console.log("setting player 2 color to: pink")):"BtnGreen2"==player2?(p=this.materialsHamGreen,m=this.bulletTypes[2],console.log("setting player 2 color to: green")):"BtnBlack2"==player2?(p=this.materialsHamBlack,m=this.bulletTypes[3],console.log("setting player 2 color to: black")):(p=this.materialsHamPink,console.log("setting player 2 color to default: Pink"))):(p=this.materialsHamPink,m=this.bulletTypes[1],console.log("setting player 2 color to default: Pink"));for(var g=0;g<2;g++)l[g].material=p[g].resource;var h=this.player2Obj.findByName("Hitbox");console.log(h);var u=h.script.get("CharacterManagerScript");u.moveLeftBtn=pc.KEY_LEFT,u.moveRightBtn=pc.KEY_RIGHT,u.moveUpBtn=pc.KEY_UP,u.moveDownBtn=pc.KEY_DOWN,u.shootBtn=pc.KEY_SPACE,u.pointsUI=this.app.root.findByName("pointsTxt2"),u.bulletType=m;var H=this.player1Obj.findByName("Hitbox").script.get("CharacterManagerScript");H.bulletType=y,H.shootBtn=pc.KEY_TAB,H.pointsUI=this.app.root.findByName("pointsTxt1")},AssignHamsters.prototype.postInitialize=function(){},AssignHamsters.prototype.update=function(t){},AssignHamsters.prototype.movePlayersToSpawn=function(){var t=app.root.findByName("SpawnPoints").children,e=this.player1Obj.parent,a=app.root.findByName(e.name),l=Math.floor(Math.random(0,1)*t.length),s=new vec3(0,0,0);s=t[l].getPosition(),a.entity.setPosition(s),console.log(a.getPosition())};var app,PrizeSpawn=pc.createScript("prizeSpawn"),timeCount=500,timeCountObstacle=600;function generateRandomFloatInRange(e,t){return Math.random()*(t-e+1)+e}function generateRandomInteger(e){return Math.floor(Math.random()*e)+1}PrizeSpawn.prototype.initialize=function(){app=this.app,entityDonut=this.app.root.findByName("donut"),entityCookie=this.app.root.findByName("cookie"),entityCupcake=this.app.root.findByName("cupcake"),entityWatermelon=this.app.root.findByName("watermelon"),entityLemon=this.app.root.findByName("lemon"),entityPear=this.app.root.findByName("pear")},PrizeSpawn.prototype.update=function(e){if(timeCount--,timeCountObstacle--,timeCount<=0){let e=generateRandomFloatInRange(-11,11),n=generateRandomFloatInRange(-11,10);var t;let o=generateRandomInteger(3);(t=1==o?entityWatermelon.clone():2==o?entityLemon.clone():3==o?entityPear.clone():entityWatermelon.clone()).setPosition(e,20,n),app.root.addChild(t),timeCount=500}if(timeCountObstacle<=0){let e=generateRandomFloatInRange(-11,11),t=generateRandomFloatInRange(-11,10);var n;let o=generateRandomInteger(3);(n=1==o?entityDonut.clone():2==o?entityCookie.clone():3==o?entityCupcake.clone():entityDonut.clone()).setPosition(e,20,t),app.root.addChild(n),timeCountObstacle=600}};var MovePlayer=pc.createScript("movePlayer");MovePlayer.attributes.add("camera",{type:"entity",description:"Optional, assign a camera entity, otherwise one is created"}),MovePlayer.attributes.add("power",{type:"number",default:300,description:"Adjusts the speed of player movement"}),MovePlayer.attributes.add("lookSpeed",{type:"number",default:.25,description:"Adjusts the sensitivity of looking"}),MovePlayer.prototype.initialize=function(){this.force=new pc.Vec3,this.eulers=new pc.Vec3;var e=this.app;e.mouse.on("mousemove",this._onMouseMove,this),e.mouse.on("mousedown",(function(){e.mouse.enablePointerLock()}),this),this.entity.collision||console.error("First Person Movement script needs to have a 'collision' component"),this.entity.rigidbody&&this.entity.rigidbody.type===pc.BODYTYPE_DYNAMIC||console.error("First Person Movement script needs to have a DYNAMIC 'rigidbody' component")},MovePlayer.prototype.update=function(e){this.camera||(this._createCamera(),this.camera.enabled=!1);var t=this.force,i=this.app,r=this.camera.forward,o=(this.camera.right,0),s=0;i.keyboard.isPressed(pc.KEY_A)&&this.entity.rigidbody.applyTorque(0,125,0),i.keyboard.isPressed(pc.KEY_D)&&this.entity.rigidbody.applyTorque(0,-125,0),i.keyboard.isPressed(pc.KEY_W)&&(o+=r.x,s+=r.z),i.keyboard.isPressed(pc.KEY_S)&&(o-=r.x,s-=r.z),0!==o&&0!==s&&(t.set(o,0,s).normalize().scale(this.power),this.entity.rigidbody.applyForce(t)),this.camera.setLocalEulerAngles(this.eulers.y,this.eulers.x,0)},MovePlayer.prototype._createCamera=function(){this.camera=new pc.Entity,this.camera.setName("First Person Camera"),this.camera.addComponent("camera"),this.entity.addChild(this.camera),this.camera.translateLocal(0,.5,0)};var Scores=pc.createScript("scores");Scores.attributes.add("scores",{type:"entity"}),Scores.attributes.add("ui",{type:"entity"}),Scores.prototype.initialize=function(){this.entity.collision.on("contact",this.onCollisionStart,this),this.koniec=!1},Scores.prototype.onCollisionStart=function(t){if("nagroda"==t.other.name){var e=parseInt(this.scores.element.text);e+=1,this.scores.element.text=e,t.other.destroy()}if("przeszkoda"==t.other.name||"donut"==t.other.name){e=parseInt(this.scores.element.text);e-=1,this.scores.element.text=e,t.other.destroy(),e<=0&&(this.ui.element.text="game over",this.scores.element.text=0,setTimeout((()=>{this.koniec=!0}),4e3))}},Scores.prototype.update=function(t){1==this.koniec&&(window.location.reload(),this.koniec=!1)};var BulletBehaviour=pc.createScript("BulletBehaviour");BulletBehaviour.attributes.add("bulletForce",{type:"Vec3"}),BulletBehaviour.prototype.initialize=function(){this.entity.collision.on("collisionstart",this.collisionstart,this),this.counter=0},BulletBehaviour.prototype.update=function(t){this.entity.rigidbody.applyImpulse(this.bulletForce),this.counter<150?this.counter+=1:this.entity.destroy()},BulletBehaviour.prototype.collisionstart=function(t){0==t.other.tags.has("players")?this.entity.destroy():1==t.other.tags.has("players")&&console.log(t.other.name)};var SpawnPlayers=pc.createScript("SpawnPlayers");SpawnPlayers.attributes.add("Spawnpoint1",{type:"entity",description:"Spawnpoint object to get position from"}),SpawnPlayers.attributes.add("Spawnpoint2",{type:"entity",description:"Spawnpoint object to get position from"}),SpawnPlayers.prototype.initialize=function(){},SpawnPlayers.prototype.update=function(t){};var CloseApp=pc.createScript("closeApp");CloseApp.prototype.initialize=function(){this.entity.button.on("click",(function(t){window.close()}),this)},CloseApp.prototype.update=function(t){};var StartGame=pc.createScript("startGame"),levelsList=[];StartGame.prototype.initialize=function(){this.entity.button.on("click",(function(t){this.startGam()}),this);for(var t=this.app.scenes.list(),e=0;e<t.length;e++)t[e].name.includes("Level")&&levelsList.push(t[e])},StartGame.prototype.update=function(t){},StartGame.prototype.startGam=function(){var t=Math.floor(Math.random(0,1)*levelsList.length),e=levelsList[t];this.app.scenes.loadSceneData(e,function(t,e){if(t)console.error(t);else{for(var a=this.app.root.children;a.length>0;)a[0].destroy();this.app.scenes.loadSceneHierarchy(e),this.app.scenes.loadSceneSettings(e),this.app.scenes.unloadSceneData(e)}}.bind(this))};var Options=pc.createScript("options");Options.prototype.initialize=function(){this.entity.button.on("click",(function(t){this.optionsGam()}),this)},Options.prototype.update=function(t){},Options.prototype.optionsGam=function(){var t=this.app.scenes.find("Options");this.app.scenes.loadSceneData(t,function(t,n){if(t)console.error(t);else{for(var i=this.app.root.children;i.length>0;)i[0].destroy();this.app.scenes.loadSceneHierarchy(n),this.app.scenes.loadSceneSettings(n),this.app.scenes.unloadSceneData(n)}}.bind(this))};var Back=pc.createScript("back");Back.prototype.initialize=function(){},Back.prototype.update=function(t){};var MenuHamsters=pc.createScript("menuHamsters");MenuHamsters.prototype.initialize=function(){app=this.app,menuScreen=this.app.root.findByName("2DScreenMenu"),hamstersScreen=this.app.root.findByName("2DScreenHamsters"),this.entity.button.on("click",(function(e){this.hamstersOn()}),this)},MenuHamsters.prototype.hamstersOn=function(){menuScreen.enabled=!1,hamstersScreen.enabled=!0};var ReturnHamsters=pc.createScript("returnHamsters");ReturnHamsters.prototype.initialize=function(){app=this.app,menuScreen=this.app.root.findByName("2DScreenMenu"),hamstersScreen=this.app.root.findByName("2DScreenHamsters"),this.entity.button.on("click",(function(e){this.hamstersOff()}),this)},ReturnHamsters.prototype.hamstersOff=function(){menuScreen.enabled=!0,hamstersScreen.enabled=!1};var ReturnOptions=pc.createScript("returnOptions");ReturnOptions.prototype.initialize=function(){app=this.app,menuScreen=this.app.root.findByName("2DScreenMenu"),optionsScreen=this.app.root.findByName("2DScreenOptions"),this.entity.button.on("click",(function(n){this.optionsOff()}),this)},ReturnOptions.prototype.optionsOff=function(){menuScreen.enabled=!0,optionsScreen.enabled=!1};var MenuOptions=pc.createScript("menuOptions");MenuOptions.prototype.initialize=function(){app=this.app,menuScreen=this.app.root.findByName("2DScreenMenu"),optionsScreen=this.app.root.findByName("2DScreenOptions"),this.entity.button.on("click",(function(n){this.optionsOn()}),this)},MenuOptions.prototype.update=function(n){},MenuOptions.prototype.optionsOn=function(){menuScreen.enabled=!1,optionsScreen.enabled=!0};var MenuInstructions=pc.createScript("menuInstructions");MenuInstructions.prototype.initialize=function(){app=this.app,menuScreen=this.app.root.findByName("2DScreenMenu"),instructionsScreen=this.app.root.findByName("2DScreenInstructions"),this.entity.button.on("click",(function(n){this.instructionsOn()}),this)},MenuInstructions.prototype.instructionsOn=function(){menuScreen.enabled=!1,instructionsScreen.enabled=!0};var ReturnInstructions=pc.createScript("returnInstructions");ReturnInstructions.prototype.initialize=function(){app=this.app,menuScreen=this.app.root.findByName("2DScreenMenu"),instructionsScreen=this.app.root.findByName("2DScreenInstructions"),this.entity.button.on("click",(function(n){this.instructionsOff()}),this)},ReturnInstructions.prototype.instructionsOff=function(){menuScreen.enabled=!0,instructionsScreen.enabled=!1};var SoundOff=pc.createScript("soundOff");SoundOff.prototype.initialize=function(){app=this.app,menuSound=this.app.root.findByName("GameSound"),this.entity.button.on("click",(function(n){this.soundOff()}),this)},SoundOff.prototype.soundOff=function(){menuSound.enabled=!1,localStorage&&localStorage.setItem("SoundOn",!1)};var SoundOn=pc.createScript("soundOn");SoundOn.prototype.initialize=function(){app=this.app,menuSound=this.app.root.findByName("GameSound"),this.entity.button.on("click",(function(n){this.soundOn()}),this)},SoundOn.prototype.soundOn=function(){menuSound.enabled=!0,localStorage&&localStorage.setItem("SoundOn",!0)};var GameSounds=pc.createScript("gameSounds");GameSounds.prototype.initialize=function(){app=this.app,gameSound=this.app.root.findByName("GameSound"),"false"==localStorage.getItem("SoundOn")?gameSound.enabled=!1:gameSound.enabled=!0};var ShootingManager=pc.createScript("shootingManager");ShootingManager.attributes.add("power",{type:"number",default:1e8}),ShootingManager.attributes.add("bullet",{type:"entity"}),ShootingManager.attributes.add("playerCamera",{type:"entity"}),ShootingManager.attributes.add("shootBtn",{type:"number",default:pc.KEY_TAB}),ShootingManager.prototype.initialize=function(){var t=this.entity.script.get("CharacterManagerScript");this.shootBtn=t.shootBtn,this.bullet=t.bulletType,this.pointsUI=t.pointsUI},ShootingManager.prototype.update=function(t){if(this.app.keyboard.wasPressed(this.shootBtn)){parseInt(this.pointsUI.element._text._text);this.shoot()}},ShootingManager.prototype.shoot=function(t){var e=this.bullet.clone();this.app.root.addChild(e),this.force=new pc.Vec3,this.force.copy(this.playerCamera.forward),this.force.y=0,this.force.scale(this.power);var a=this.playerCamera.getPosition();this.playerCamera.forward;e.setPosition(a);var o=this.playerCamera.getRotation();e.setRotation(o),e.rotateLocal(0,90,0),e.script.get("BulletBehaviour").bulletForce=this.force,e.enabled=!0};var HamsterPick=pc.createScript("hamsterPick");HamsterPick.prototype.initialize=function(){app=this.app,btnYellow1=this.app.root.findByName("BtnYellow1"),btnPink1=this.app.root.findByName("BtnPink1"),btnGreen1=this.app.root.findByName("BtnGreen1"),btnBlack1=this.app.root.findByName("BtnBlack1"),buttons1=[btnYellow1,btnPink1,btnGreen1,btnBlack1],this.entity.button.on("click",(function(t){this.picking()}),this)},HamsterPick.prototype.picking=function(){let t;for(t=0;t<4;t++)buttons1[t]==this.entity?localStorage&&localStorage.setItem("Player1",buttons1[t].name):buttons1[t].button.active=!1};var HamsterPickPlayer2=pc.createScript("hamsterPickPlayer2");HamsterPickPlayer2.prototype.initialize=function(){app=this.app,btnYellow2=this.app.root.findByName("BtnYellow2"),btnPink2=this.app.root.findByName("BtnPink2"),btnGreen2=this.app.root.findByName("BtnGreen2"),btnBlack2=this.app.root.findByName("BtnBlack2"),buttons2=[btnYellow2,btnPink2,btnGreen2,btnBlack2],this.entity.button.on("click",(function(t){this.picking2()}),this)},HamsterPickPlayer2.prototype.update=function(t){},HamsterPickPlayer2.prototype.picking2=function(){let t;for(t=0;t<4;t++)buttons2[t]==this.entity?localStorage&&localStorage.setItem("Player2",buttons2[t].name):buttons2[t].button.active=!1};var BackTomenu=pc.createScript("backTomenu");BackTomenu.prototype.initialize=function(){this.entity.button.on("click",(function(e){this.backToMenu()}),this)},BackTomenu.prototype.update=function(e){},BackTomenu.prototype.backToMenu=function(){var e=this.app.scenes.find("Menu");this.app.scenes.loadSceneData(e,function(e,n){if(e)console.error(e);else{for(var t=this.app.root.children;t.length>0;)t[0].destroy();this.app.scenes.loadSceneHierarchy(n),this.app.scenes.loadSceneSettings(n),this.app.scenes.unloadSceneData(n)}}.bind(this))};var PointsSystem=pc.createScript("PointsSystem");PointsSystem.attributes.add("pointsUI",{type:"entity"}),PointsSystem.attributes.add("ui",{type:"entity"}),PointsSystem.prototype.initialize=function(){this.entity.collision.on("contact",this.onContact,this),this.entity.collision.on("collisionstart",this.onCollisionStart,this),this.koniec=!1},PointsSystem.prototype.update=function(t){if(1==this.koniec){for(var e=this.app.scenes.find("Menu"),i=this.app.root.children;i.length>0;)i[0].destroy();this.app.scenes.loadSceneHierarchy(e,(function(t,e){t&&console.error(t)}))}},PointsSystem.prototype.onContact=function(t){var e=0;if(t.other.tags.has("nagroda")&&(this.entity.sound.play("eating"),e=parseInt(this.pointsUI.element._text._text),(e+=1)>=20&&(this.ui.element._text._setText(this.entity.name+"\n Won"),setTimeout((()=>{this.koniec=!0}),4e3)),this.pointsUI.element._text._setText(e.toString()),t.other.destroy()),t.other.tags.has("przeszkoda")){if(this.entity.sound.play("hit"),e=parseInt(this.pointsUI.element._text._text),(e-=1)<=0){var i="";i="Player 1"==this.entity.name?"Player 2":"Player 1",this.ui.element._text._setText(i+"\n Won"),setTimeout((()=>{this.koniec=!0}),4e3)}this.pointsUI.element._text._setText(e.toString()),t.other.destroy()}},PointsSystem.prototype.onCollisionStart=function(t){},PointsSystem.prototype.getWinner=function(){};var ShootingSound=pc.createScript("shootingSound");ShootingSound.prototype.initialize=function(){},ShootingSound.prototype.update=function(o){this.app.keyboard.wasPressed(pc.KEY_TAB)&&this.entity.sound.play("shooting"),this.app.keyboard.wasPressed(pc.KEY_SPACE)&&this.entity.sound.play("shooting")};